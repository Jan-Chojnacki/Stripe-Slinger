raid-simulator-coverage:
  stage: quality
  needs:
    - { job: raid-simulator-tests, artifacts: true }
  script:
    - .gitlab/ci/raid-simulator/scripts/coverage.sh
  artifacts:
    reports:
      coverage_report:
        coverage_format: cobertura
        path: reports/coverage.xml
    paths:
      - reports/coverage.xml
    expire_in: 1 week
  rules:
    - !reference [.rules-master-always, rules]
    - !reference [.rules-mr-master-code, rules]
    - !reference [.rules-mr-develop-code, rules]
    - !reference [.rules-dev-code, rules]
    - !reference [.rules-feature-code-soft, rules]
    - when: never

raid-simulator-audit:
  stage: quality
  script:
    - .gitlab/ci/raid-simulator/scripts/audit.sh
  rules:
    - !reference [.rules-master-always, rules]
    - !reference [.rules-mr-master-code, rules]
    - !reference [.rules-mr-develop-code, rules]
    - !reference [.rules-dev-code, rules]
    - !reference [.rules-feature-code-soft, rules]
    - when: never
